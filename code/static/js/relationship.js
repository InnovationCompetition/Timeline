(function(){angular.module("relationship",["ngMaterial"]).controller("relationshipController",["$scope","$interval",function(e,t){var n,o,r,s,a,i,l,f,h,g,u,c;for(e.hold="first",e.counter=0,e.color=["#FF5722","#FF9800","#8BC34A","#F44336","#9E9E9E","#795548"],e.monthText=["一月","二月","三月"],n=[10,10,10],e.messages=[],o=0;o<=2;++o)for(r=o,s=1,a=n[r];s<=a;++s){for(i=s,l=[],f=1;f<=5;++f)h=f,0===parseInt(4*Math.random())&&l.push("../img/demo/"+h+".jpg");e.messages.push({id:r+"_"+i,month:e.monthText[r],date:i,isShare:0===parseInt(5*Math.random()),shareNum:l.length,shareFaces:l,isOpen:!1})}g=function(e){return document.getElementById(e)},u=function(e){var t,n;for(t=e.offsetLeft,n=e.offsetParent;t+=n.offsetLeft,n=n.offsetParent,null!==n;);return t},c=function(e){var t,n;for(t=e.offsetTop,n=e.offsetParent;t+=n.offsetTop,n=n.offsetParent,null!==n;);return t},e.showFriend=function(){var t,n,o,r;for(g("canvas").height=g("list").offsetHeight,g("canvas").width=g("list").offsetWidth,t=0,o=(n=e.messages).length;t<o;++t)r=n[t],r.isOpen=!1},e.getFriend=function(t,n,o){var r,s,a,i,l,f,h,m,d,p,v,T,F,E,P,y,C,x,B;for(t.stopImmediatePropagation(),e.hold!==n?(g("canvas").height=g("list").offsetHeight,g("canvas").width=g("list").offsetWidth,r=g("canvas").getContext("2d"),r.strokeStyle="#009688",e.counter=0):(r=g("canvas").getContext("2d"),r.strokeStyle=e.color[e.counter],e.counter++),e.hold=n,n.isOpen=!0,s=u(t.target),a=c(t.target),r.beginPath(),r.lineCap="round",r.lineWidth=5,r.lineJoin="round",i=0,l=36,f=0,m=(h=document.getElementsByTagName("md-list-item")).length;f<m;++f)for(d=h[f],p=d.getElementsByTagName("img"),v=0,T=p.length;v<T;++v)F=p[v],E=String(F.src),E=E.substr(E.length-8,8),P=o.substr(o.length-8,8),E===P&&(0===i?(F.alt===n?r.moveTo(s+20,a-298):(y=u(d),C=c(d),x=y,B=C,r.moveTo(y+38,C-272)),i=1):F.alt===n?(r.lineTo(s+20,B-272+l),r.lineTo(s+20,a-298)):(y=u(d),C=c(d),B+72===C?r.lineTo(y+38,C-272):(r.lineTo(s+20,B-272+l),r.lineTo(s+20,C-272-l),r.lineTo(y+38,C-272)),x=y,B=C));r.stroke()}}])}).call(this);